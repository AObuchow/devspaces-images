======= BOOTSTRAP DOCKERFILE =======>
#
# Copyright (c) 2018-2022 Red Hat, Inc.
# This program and the accompanying materials are made
# available under the terms of the Eclipse Public License 2.0
# which is available at https://www.eclipse.org/legal/epl-2.0/
#
# SPDX-License-Identifier: EPL-2.0
#
# Contributors:
#   Red Hat, Inc. - initial API and implementation
#   IBM Corporation - implementation
#

# Builder: check meta.yamls and create index.json
# registry.access.redhat.com/ubi8/python-38
FROM registry-proxy.engineering.redhat.com/rh-osbs/ubi8-python-38:1-100 as builder
USER 0

ARG BOOTSTRAP=true
ENV BOOTSTRAP=${BOOTSTRAP}
# if not defined or string is null, allow all registries/tags in list_referenced_images
# otherwise restrict to only those space-separated registries/tags; if others found, build will fail
# useful for failing build if quay images in an RC, or wrong devspaces image tag (3.2 in 3.1 build)
ARG ALLOWED_REGISTRIES=""
ENV ALLOWED_REGISTRIES=${ALLOWED_REGISTRIES}
ARG ALLOWED_TAGS=""
ENV ALLOWED_TAGS=${ALLOWED_TAGS}

COPY ./build/dockerfiles/content_sets_rhel8.repo /etc/yum.repos.d/
COPY ./build/dockerfiles/rhel.install.sh /tmp
RUN /tmp/rhel.install.sh && rm -f /tmp/rhel.install.sh

COPY ./build/scripts ./versions.json /build/
COPY ./build/scripts/clone_and_zip.sh /build/build/scripts/
COPY ./VERSION /
COPY ./devfiles /build/devfiles
WORKDIR /build/

RUN ./generate_devworkspace_templates.sh
RUN chmod -R g+rwX /build/resources

# validate devfile content
RUN ./check_referenced_images.sh devfiles --registries "${ALLOWED_REGISTRIES}" --tags "${ALLOWED_TAGS}"
RUN ./check_mandatory_fields.sh devfiles

# Cache projects in DS 
COPY ./build/dockerfiles/rhel.cache_projects.sh /tmp/ 
RUN /tmp/rhel.cache_projects.sh /build/ && rm -rf /tmp/rhel.cache_projects.sh /tmp/resources.tgz 

# don't do swaps, or we end up with missing content if built on s390x or ppc64le worker
# RUN ./swap_yamlfiles.sh devfiles
# RUN ./swap_images.sh devfiles
RUN ./index.sh > /build/devfiles/index.json && \
    ./list_referenced_images.sh devfiles > /build/devfiles/external_images.txt && \
    ./list_referenced_images_by_file.sh devfiles > /build/devfiles/external_images_by_devfile.txt && \
    chmod -R g+rwX /build/devfiles

<======= BOOTSTRAP DOCKERFILE =======
======= START BOOTSTRAP BUILD =======>
STEP 1/23: FROM registry-proxy.engineering.redhat.com/rh-osbs/ubi8-python-38:1-100 AS builder
STEP 2/23: USER 0
--> d95239301cf
STEP 3/23: ARG BOOTSTRAP=true
--> 101f306403d
STEP 4/23: ENV BOOTSTRAP=${BOOTSTRAP}
--> f723d0e6f5c
STEP 5/23: ARG ALLOWED_REGISTRIES=""
--> 05d2689472e
STEP 6/23: ENV ALLOWED_REGISTRIES=${ALLOWED_REGISTRIES}
--> 1b5c54bac31
STEP 7/23: ARG ALLOWED_TAGS=""
--> d6b1b86a92b
STEP 8/23: ENV ALLOWED_TAGS=${ALLOWED_TAGS}
--> 773f060cb33
STEP 9/23: COPY ./build/dockerfiles/content_sets_rhel8.repo /etc/yum.repos.d/
--> 0ff42979588
STEP 10/23: COPY ./build/dockerfiles/rhel.install.sh /tmp
--> e57305aa7d1
STEP 11/23: RUN /tmp/rhel.install.sh && rm -f /tmp/rhel.install.sh

Upgraded:
  bash-4.4.20-4.el8_6.x86_64                                                    
  dnf-4.7.0-11.el8.noarch                                                       
  dnf-data-4.7.0-11.el8.noarch                                                  
  nodejs-1:14.20.1-2.module+el8.7.0+16991+b0a68a3e.x86_64                       
  nodejs-docs-1:14.20.1-2.module+el8.7.0+16991+b0a68a3e.noarch                  
  nodejs-full-i18n-1:14.20.1-2.module+el8.7.0+16991+b0a68a3e.x86_64             
  npm-1:6.14.17-1.14.20.1.2.module+el8.7.0+16991+b0a68a3e.x86_64                
  python3-dnf-4.7.0-11.el8.noarch                                               
  python38-3.8.13-1.module+el8.7.0+15641+2ece4388.x86_64                        
  python38-devel-3.8.13-1.module+el8.7.0+15641+2ece4388.x86_64                  
  python38-libs-3.8.13-1.module+el8.7.0+15641+2ece4388.x86_64                   
  python38-pip-19.3.1-6.module+el8.7.0+15823+8950cfa7.noarch                    
  tar-2:1.30-6.el8.x86_64                                                       
  yum-4.7.0-11.el8.noarch                                                       
Installed:
  containers-common-2:1-43.module+el8.7.0+17064+3b31f55c.x86_64                 
  criu-3.15-3.module+el8.7.0+17064+3b31f55c.x86_64                              
  fuse-common-3.3.0-16.el8.x86_64                                               
  fuse-overlayfs-1.9-1.module+el8.7.0+17064+3b31f55c.x86_64                     
  fuse3-3.3.0-16.el8.x86_64                                                     
  fuse3-libs-3.3.0-16.el8.x86_64                                                
  iptables-libs-1.8.4-23.el8.x86_64                                             
  jansson-2.14-1.el8.x86_64                                                     
  jq-1.6-3.el8.x86_64                                                           
  kmod-25-19.el8.x86_64                                                         
  libibverbs-41.0-1.el8.x86_64                                                  
  libmnl-1.0.4-6.el8.x86_64                                                     
  libnet-1.1.6-15.el8.x86_64                                                    
  libnftnl-1.1.5-5.el8.x86_64                                                   
  libpcap-14:1.9.1-5.el8.x86_64                                                 
  libslirp-4.4.0-1.module+el8.7.0+17064+3b31f55c.x86_64                         
  nftables-1:0.9.3-26.el8.x86_64                                                
  oniguruma-6.8.2-2.el8.x86_64                                                  
  protobuf-c-1.3.0-6.el8.x86_64                                                 
  runc-1:1.1.4-1.module+el8.7.0+17064+3b31f55c.x86_64                           
  skopeo-2:1.9.3-1.module+el8.7.0+17064+3b31f55c.x86_64                         
  slirp4netns-1.2.0-2.module+el8.7.0+17064+3b31f55c.x86_64                      

Collecting yq
  Downloading https://files.pythonhosted.org/packages/60/2c/ab35b5ec3b884b6e33b18ba3f6be6b94d607501fca1e5a8de22988690cdb/yq-3.1.0-py3-none-any.whl
Collecting argcomplete
  Downloading https://files.pythonhosted.org/packages/d3/e5/c5509683462e51b070df9e83e7f72c1ccfe3f733f328b4a0f06804c27278/argcomplete-2.0.0-py2.py3-none-any.whl
Collecting PyYAML>=5.3.1
  Downloading https://files.pythonhosted.org/packages/d7/42/7ad4b6d67a16229496d4f6e74201bdbebcf4bc1e87d5a70c9297d4961bd2/PyYAML-6.0-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (701kB)
Collecting xmltodict>=0.11.0
  Downloading https://files.pythonhosted.org/packages/94/db/fd0326e331726f07ff7f40675cd86aa804bfd2e5016c727fa761c934990e/xmltodict-0.13.0-py2.py3-none-any.whl
Collecting toml>=0.10.0
  Downloading https://files.pythonhosted.org/packages/44/6f/7120676b6d73228c96e17f1f794d8ab046fc910d781c8d151120c3f1569e/toml-0.10.2-py2.py3-none-any.whl
Installing collected packages: argcomplete, PyYAML, xmltodict, toml, yq
Successfully installed PyYAML-6.0 argcomplete-2.0.0 toml-0.10.2 xmltodict-0.13.0 yq-3.1.0
python: Python 3.8.13
yq: yq 3.1.0
jq: jq-1.6
--> 6563094e90d
STEP 12/23: COPY ./build/scripts ./versions.json /build/
--> cc5810d0fe2
STEP 13/23: COPY ./build/scripts/clone_and_zip.sh /build/build/scripts/
--> 48de1f69f00
STEP 14/23: COPY ./VERSION /
--> a9e706d6599
STEP 15/23: COPY ./devfiles /build/devfiles
--> 059ff9c3f0a
STEP 16/23: WORKDIR /build/
--> 86299492665
STEP 17/23: RUN ./generate_devworkspace_templates.sh

> core-js@2.6.12 postinstall /build/node_modules/core-js
> node -e "try{require('./postinstall')}catch(e){}"

[96mThank you for using core-js ([94m https://github.com/zloirock/core-js [96m) for polyfilling JavaScript standard library![0m

[96mThe project needs your help! Please consider supporting of core-js on Open Collective or Patreon: [0m
[96m>[94m https://opencollective.com/core-js [0m
[96m>[94m https://www.patreon.com/zloirock [0m

[96mAlso, the author of core-js ([94m https://github.com/zloirock [96m) is looking for a good job -)[0m

+ @eclipse-che/che-theia-devworkspace-handler@0.0.1-1649678182
added 120 packages from 183 contributors and audited 120 packages in 14.56s

5 packages are looking for funding
  run `npm fund` for details

found 1 high severity vulnerability
  run `npm audit fix` to fix them, or `npm audit` for details
+ @eclipse-che/che-code-devworkspace-handler@1.64.0-dev-210b722
added 2 packages from 1 contributor and audited 239 packages in 2.241s

5 packages are looking for funding
  run `npm fund` for details

found 5 high severity vulnerabilities
  run `npm audit fix` to fix them, or `npm audit` for details
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
No sidecar policy. Setting to useDevContainer
--> 88f824784a7
STEP 18/23: RUN chmod -R g+rwX /build/resources
--> ddd4805ef57
STEP 19/23: RUN ./check_referenced_images.sh devfiles --registries "${ALLOWED_REGISTRIES}" --tags "${ALLOWED_TAGS}"
 + registry.redhat.io/devspaces/code-rhel8:3.5 PASS - 3.5 allowed
 + registry.redhat.io/devspaces/machineexec-rhel8:3.5 PASS - 3.5 allowed
 + registry.redhat.io/devspaces/theia-endpoint-rhel8:3.5 PASS - 3.5 allowed
 + registry.redhat.io/devspaces/theia-rhel8:3.5 PASS - 3.5 allowed
 + registry.redhat.io/devspaces/udi-rhel8:3.5 PASS - 3.5 allowed
 = registry.redhat.io/rhscl/mongodb-36-rhel7:1-50 PASS
--> dbd7c11b4d6
STEP 20/23: RUN ./check_mandatory_fields.sh devfiles
Checking devfile 'devfiles/TP__cpp__c-plus-plus/meta.yaml'
Checking devfile 'devfiles/TP__dotnet__dotnet-web-simple/meta.yaml'
Checking devfile 'devfiles/TP__go__golang-health-check/meta.yaml'
Checking devfile 'devfiles/TP__php__php-hello-world/meta.yaml'
Checking devfile 'devfiles/java11-maven-lombok__lombok-project-sample/meta.yaml'
Checking devfile 'devfiles/java11-maven-quarkus__quarkus-quickstarts/meta.yaml'
Checking devfile 'devfiles/nodejs__nodejs-mongodb-sample/meta.yaml'
Checking devfile 'devfiles/nodejs__web-nodejs-sample/meta.yaml'
Checking devfile 'devfiles/python__python-hello-world/meta.yaml'
--> 18463f8e77f
STEP 21/23: COPY ./build/dockerfiles/rhel.cache_projects.sh /tmp/ 
--> 853adc25d79
STEP 22/23: RUN /tmp/rhel.cache_projects.sh /build/ && rm -rf /tmp/rhel.cache_projects.sh /tmp/resources.tgz 
--> e38133c0dee
STEP 23/23: RUN ./index.sh > /build/devfiles/index.json &&     ./list_referenced_images.sh devfiles > /build/devfiles/external_images.txt &&     ./list_referenced_images_by_file.sh devfiles > /build/devfiles/external_images_by_devfile.txt &&     chmod -R g+rwX /build/devfiles
COMMIT devfileregistry:tmp
--> 52fc3326abd
Successfully tagged localhost/devfileregistry:tmp
52fc3326abd09fa451436bf306d7ce1567f0a47642c0e9d5f595a7c12dd28f97
<======= END BOOTSTRAP BUILD =======
Downloading root-local.tgz
Downloading resources.tgz
DIFF START *****
diff --suppress-common-lines -u -r -x '*.pyc' -x installed-files.txt /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/METADATA /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/METADATA
--- /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/METADATA	2023-01-01 17:25:12.000000000 -0500
+++ /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/METADATA	2023-01-02 05:17:24.314771996 -0500
@@ -3,10 +3,10 @@
 Version: 6.0
 Summary: YAML parser and emitter for Python
 Home-page: https://pyyaml.org/
-Download-URL: https://pypi.org/project/PyYAML/
 Author: Kirill Simonov
 Author-email: xi@resolvent.net
 License: MIT
+Download-URL: https://pypi.org/project/PyYAML/
 Project-URL: Bug Tracker, https://github.com/yaml/pyyaml/issues
 Project-URL: CI, https://github.com/yaml/pyyaml/actions
 Project-URL: Documentation, https://pyyaml.org/wiki/PyYAMLDocumentation
@@ -43,3 +43,4 @@
 
 PyYAML is applicable for a broad range of tasks from complex
 configuration files to object serialization and persistence.
+
diff --suppress-common-lines -u -r -x '*.pyc' -x installed-files.txt /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/RECORD /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/RECORD
--- /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/RECORD	2023-01-01 17:25:12.000000000 -0500
+++ /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/RECORD	2023-01-02 05:17:24.314771996 -0500
@@ -1,8 +1,8 @@
 PyYAML-6.0.dist-info/INSTALLER,sha256=zuuue4knoyJ-UwPPXg8fezS7VCrXJQrAP7zeNuwvFQg,4
 PyYAML-6.0.dist-info/LICENSE,sha256=jTko-dxEkP1jVwfLiOsmvXZBAqcoKVQwfT5RZ6V36KQ,1101
-PyYAML-6.0.dist-info/METADATA,sha256=Q56A1jQxEnzMMCyqgYkqM5Egvr9y18VExGF3ciGLjlY,2005
+PyYAML-6.0.dist-info/METADATA,sha256=QmHx9kGp_0yezQCXYaft4eEFeJ6W4oyFfYwHDLP1kdg,2006
 PyYAML-6.0.dist-info/RECORD,,
-PyYAML-6.0.dist-info/WHEEL,sha256=f8vErwyDyFouYea3KNqXIy0we1lRdJObBl1MFdhTmU0,104
+PyYAML-6.0.dist-info/WHEEL,sha256=RiwktpmF40OphKd3_aIG01PzIOQlJ7dpBn3cFSc9vak,217
 PyYAML-6.0.dist-info/top_level.txt,sha256=rpj0IVMTisAjh_1vG3Ccf9v5jpCQwAz6cD1IVU5ZdhQ,11
 _yaml/__init__.py,sha256=04Ae_5osxahpJHa3XBZUAf4wi6XX32gR8D6X6p64GEA,1402
 _yaml/__pycache__/__init__.cpython-38.pyc,,
@@ -24,6 +24,7 @@
 yaml/__pycache__/scanner.cpython-38.pyc,,
 yaml/__pycache__/serializer.cpython-38.pyc,,
 yaml/__pycache__/tokens.cpython-38.pyc,,
+yaml/_yaml.cpython-38-x86_64-linux-gnu.so,sha256=lMaKSmQZy3WNZSmmU0Wg5Y5ZAs-HR5vItyGVUIsp8Rg,2847784
 yaml/composer.py,sha256=_Ko30Wr6eDWUeUpauUGT3Lcg9QPBnOPVlTnIMRGJ9FM,4883
 yaml/constructor.py,sha256=kNgkfaeLUkwQYY_Q6Ff1Tz2XVw_pG1xVE9Ak7z-viLA,28639
 yaml/cyaml.py,sha256=6ZrAG9fAYvdVe2FK_w0hmXoG7ZYsoYUwapG8CiC72H0,3851
diff --suppress-common-lines -u -r -x '*.pyc' -x installed-files.txt /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/WHEEL /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/WHEEL
--- /tmp/tmp.LIeUpTMGdv/lib/python3.8/site-packages/PyYAML-6.0.dist-info/WHEEL	2023-01-01 17:25:12.000000000 -0500
+++ /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/PyYAML-6.0.dist-info/WHEEL	2023-01-02 05:17:24.314771996 -0500
@@ -1,5 +1,8 @@
 Wheel-Version: 1.0
-Generator: bdist_wheel (0.38.4)
+Generator: bdist_wheel (0.37.0)
 Root-Is-Purelib: false
-Tag: cp38-cp38-linux_ppc64le
+Tag: cp38-cp38-manylinux_2_5_x86_64
+Tag: cp38-cp38-manylinux1_x86_64
+Tag: cp38-cp38-manylinux_2_12_x86_64
+Tag: cp38-cp38-manylinux2010_x86_64
 
Only in /tmp/tmp.svJkbF6gMe/lib/python3.8/site-packages/yaml: _yaml.cpython-38-x86_64-linux-gnu.so
***** END DIFF
DIFF START *****
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/java11-maven-lombok__lombok-project-sample/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/java11-maven-lombok__lombok-project-sample/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/java11-maven-lombok__lombok-project-sample/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/java11-maven-lombok__lombok-project-sample/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.401771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/java11-maven-quarkus__quarkus-quickstarts/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/java11-maven-quarkus__quarkus-quickstarts/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/java11-maven-quarkus__quarkus-quickstarts/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/java11-maven-quarkus__quarkus-quickstarts/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.401771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/nodejs__nodejs-mongodb-sample/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/nodejs__nodejs-mongodb-sample/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/nodejs__nodejs-mongodb-sample/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/nodejs__nodejs-mongodb-sample/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.401771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/nodejs__web-nodejs-sample/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/nodejs__web-nodejs-sample/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/nodejs__web-nodejs-sample/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/nodejs__web-nodejs-sample/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.401771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/python__python-hello-world/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/python__python-hello-world/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/python__python-hello-world/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/python__python-hello-world/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.402771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/TP__cpp__c-plus-plus/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/TP__cpp__c-plus-plus/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/TP__cpp__c-plus-plus/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/TP__cpp__c-plus-plus/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.400771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/TP__dotnet__dotnet-web-simple/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/TP__dotnet__dotnet-web-simple/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/TP__dotnet__dotnet-web-simple/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/TP__dotnet__dotnet-web-simple/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.400771996 -0500
@@ -110,6 +110,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -139,9 +162,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/TP__go__golang-health-check/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/TP__go__golang-health-check/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/TP__go__golang-health-check/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/TP__go__golang-health-check/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.400771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
diff --suppress-common-lines -u -r /tmp/tmp.IMFm7D7ire/devfiles/TP__php__php-hello-world/devworkspace-che-theia-latest.yaml /tmp/tmp.mnWE0orppl/devfiles/TP__php__php-hello-world/devworkspace-che-theia-latest.yaml
--- /tmp/tmp.IMFm7D7ire/devfiles/TP__php__php-hello-world/devworkspace-che-theia-latest.yaml	2022-12-22 09:54:41.000000000 -0500
+++ /tmp/tmp.mnWE0orppl/devfiles/TP__php__php-hello-world/devworkspace-che-theia-latest.yaml	2023-01-02 05:17:25.400771996 -0500
@@ -109,6 +109,29 @@
       volume: {}
     - name: theia-local
       volume: {}
+    - name: theia-ide-contributions
+      container:
+        image: registry.redhat.io/devspaces/udi-rhel8:3.5
+        args:
+          - sh
+          - '-c'
+          - ${PLUGIN_REMOTE_ENDPOINT_EXECUTABLE}
+        env:
+          - name: PLUGIN_REMOTE_ENDPOINT_EXECUTABLE
+            value: /remote-endpoint/plugin-remote-endpoint
+          - name: THEIA_PLUGINS
+            value: local-dir:///plugins/sidecars/tools
+        volumeMounts:
+          - name: plugins
+            path: /plugins
+          - name: remote-endpoint
+            path: /remote-endpoint
+        memoryLimit: 512Mi
+      attributes:
+        controller.devfile.io/container-contribution: true
+    - name: remote-endpoint
+      volume:
+        ephemeral: true
     - name: che-machine-exec
       container:
         image: registry.redhat.io/devspaces/machineexec-rhel8:3.5
@@ -138,9 +161,6 @@
         memoryRequest: 32Mi
         cpuLimit: 500m
         cpuRequest: 30m
-    - name: remote-endpoint
-      volume:
-        ephemeral: true
 ---
 apiVersion: workspace.devfile.io/v1alpha2
 kind: DevWorkspace
***** END DIFF
Untagged: localhost/devfileregistry:tmp
Deleted: 52fc3326abd09fa451436bf306d7ce1567f0a47642c0e9d5f595a7c12dd28f97
Deleted: e38133c0dee80321feabbf889dd77de286acc04b8594f42c5aedfe14602d8416
Deleted: 853adc25d7997bba20319a6a124e9d22deaa655129c36df2d2042a822e2971b8
Deleted: 18463f8e77faab503e01c699681e49e52208d2f626add6d84ac9ff658caa0432
Deleted: dbd7c11b4d6a1341dc54dd6ad2c98a0239fc54d1d8769ad06803ae32e8271828
Deleted: ddd4805ef573f0cf146ae390082b36ab62810c730462e5f70617946d9e1c453e
Deleted: 88f824784a7d1f5267bb37a339585c3bbed93b90380c11213b6c78693b422745
Deleted: 86299492665ce737405f189580ef33153120dbda8966e66c0845f6e32689d35d
Deleted: 059ff9c3f0a04ff6b46dc8e753caccd327d1b28b3b5cf165bcb58df5b65a506f
Deleted: a9e706d65996bf47ae2f8e953f9a67f13a1e1b0b96f09c7ac794acb788debaf1
Deleted: 48de1f69f003fd04fe053839748e4acbcc63f2e8e6f4707ce09936cb39d8c164
Deleted: cc5810d0fe2b7788075a15a5ea3c783da09804655deaf2cce148528844821807
Deleted: 6563094e90d3e8c08c7044a66982152d5ea4fcedcafec184c936200064b72597
Deleted: e57305aa7d1bc18fc0e42cbc79abaf171b443efd6865e69e72b77c8f80106f8b
Deleted: 0ff429795884a4102289e04e7c6b9c24951b0a4d99338f581b323cedd0daab9d
Deleted: 773f060cb332285012e51f270b8b9ea3e9eaec266672ed150ecb4b49de712d67
Deleted: d6b1b86a92b36f4e7bbd674494449d1b6150c53a99d7177349ce9f0594446db4
Deleted: 1b5c54bac31b7c017311ffe77e6d8cad80a0e2331d3900518dfd3748c40b7f5c
Deleted: 05d2689472ed25035b2d683d6789b1a96c37ab7a91ab682dbfc514e8b7c349d8
Deleted: f723d0e6f5c4bc0c1d125ad71748ccde9bc63a6619d10de95303b8bd4061dc1c
Deleted: 101f306403d7855e92519c286c2dff9619eb57fdfed1f8ab8c317e09bf7e9e8b
Deleted: d95239301cf390b4790a69d6b1b2e8b02dd05a4fb9527e7cba1fcfe8c58c29b7
Uploading: root-local.tgz
Uploading: resources.tgz
Source upload succeeded. Don't forget to commit the sources file
rm 'resources.tgz'
rm 'root-local.tgz'
